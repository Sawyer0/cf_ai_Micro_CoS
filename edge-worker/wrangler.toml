name = "micro-cos-edge-worker"
main = "src/index.ts"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]

[ai]
binding = "AI"

[[kv_namespaces]]
binding = "IDEMPOTENCY_KV"
id = "98a796435557479c97e31b060f945b8e"

[[kv_namespaces]]
binding = "RATE_LIMIT_KV"
id = "beb522405ec345f5b7256661cbc3b0df"

[durable_objects]
bindings = [
  { name = "CHAT_SESSIONS", class_name = "ChatSessionDO" },
]

[[workflows]]
name = "travel-planning-workflow"
binding = "TRAVEL_PLANNING"
class_name = "TravelPlanningWorkflow"

[[workflows]]
name = "task-extraction-workflow"
binding = "TASK_EXTRACTION"
class_name = "TaskExtractionWorkflow"

[[workflows]]
name = "daily-planning-workflow"
binding = "DAILY_PLANNING"
class_name = "DailyPlanningWorkflow"

[observability]
enabled = true
head_sampling_rate = 1

[observability.logs]
enabled = true
invocation_logs = true

[[migrations]]
tag = "v1-chat-sessions"
new_sqlite_classes = ["ChatSessionDO"]

[[d1_databases]]
binding = "DB"
database_name = "micro_cos_db"
database_id = "9ed5f7e4-869e-4b73-b725-8d041714e369"

[vars]
WORKERS_AI_MODEL_ID = "@cf/meta/llama-3.3-70b-instruct-fp8-fast"